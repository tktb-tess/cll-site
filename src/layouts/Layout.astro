---
import '../styles/globals.css';
import { linkTitles } from '../modules/titles';
import Preloads from './Preloads.astro';

export interface Props {
  readonly frontmatter: {
    readonly title: string;
    readonly description?: string;
  };
  readonly file: string;
  readonly url: string;
  readonly getHeadings: () => {
    depth: number;
    slug: string;
    text: string;
  }[];
  readonly rawContent: () => string;
  readonly compiledContent: () => string;
}

const { frontmatter } = Astro.props;
const url = (() => {
  const { url } = Astro.props;
  return url !== '' ? url : '/';
})();

const index = linkTitles.findIndex(([k]) => k === url);
const prev = index > 0 ? linkTitles.at(index - 1) : undefined;
const next =
  index >= 0 && index < linkTitles.length - 1
    ? linkTitles.at(index + 1)
    : undefined;
---

<!doctype html>
<html lang='en'>
  <head>
    <meta charset='utf-8' />
    <meta name='viewport' content='width=device-width,initial-scale=1' />
    <meta name='generator' content={Astro.generator} />

    <!-- preloads -->
    <Preloads />

    <!-- font-face -->
    <link
      rel='stylesheet'
      href='https://api.tktb-tess.dev/fonts/Inter/font-face.css'
      crossorigin='anonymous'
    />
    <link
      rel='stylesheet'
      href='https://api.tktb-tess.dev/fonts/Charis/font-face.css'
      crossorigin='anonymous'
    />

    <!-- KaTeX -->
    <link
      rel='stylesheet'
      href='https://cdn.jsdelivr.net/npm/katex@0.16.27/dist/katex.min.css'
      integrity='sha384-Pu5+C18nP5dwykLJOhd2U4Xen7rjScHN/qusop27hdd2drI+lL5KvX7YntvT8yew'
      crossorigin='anonymous'
    />

    <link rel='icon' href='/icon.svg' type='image/svg+xml' />
    <title>{frontmatter.title}</title>
  </head>
  <body>
    <div id='md-root'>
      <header
        class='flex flex-col gap-2 px-4 w-full max-w-7xl mx-auto my-8 *:my-0'
      >
        <p class='text-center text-xl'>The Complete Lojban Language</p>
        <div class='flex justify-center gap-4'>
          {prev && <a href={prev[0]}>&lt;- {prev[1]}</a>}
          {next && <a href={next[0]}>{next[1]} -&gt;</a>}
        </div>
        <p class='text-center'><a href='/'>Table of Contents</a></p>
        <p class='text-center'>
          <a href='https://mw.lojban.org/papri/The_Complete_Lojban_Language'>
            Book Info Page
          </a>
        </p>
      </header>
      <main>
        <h1 id='title'>
          {frontmatter.title}
        </h1>
        <slot />
      </main>
    </div>
  </body>
</html>
